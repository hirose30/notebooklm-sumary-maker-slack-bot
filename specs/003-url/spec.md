# Feature Specification: Suppress URL Thumbnail in Queue Acknowledgment

**Feature Branch**: `003-url`
**Created**: 2025-10-13
**Status**: Draft
**Input**: User description: "もう一つ修正したい点としては、処理キューの追加の確認時に メッセージ内にURLを展開すると、サムネイル展開がされてしまうので、処理の有無だけを示してくれればいいです"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - Clean Queue Acknowledgment (Priority: P0)

ユーザーがボットにURLをメンションすると、処理キューに追加された確認メッセージが表示される。現在、メッセージ内にURLが含まれているため、Slackがサムネイルやプレビューを自動展開してしまい、メッセージが視覚的にノイズになっている。ユーザーは処理が受け付けられたことだけを簡潔に知りたい。

**Why this priority**:
- 現在のサムネイル展開により、Slackチャンネルが視覚的に乱雑になる
- ユーザーは処理受付の確認だけが必要で、URL情報は既に入力済み
- UX改善により、ボットメッセージがより洗練され、チャンネルの可読性が向上する
- 既存機能の改善なので、即座に実装可能

**Independent Test**: ボットにURLをメンションし、確認メッセージにURLが含まれず、サムネイルが展開されないことを確認する

**Acceptance Scenarios**:

1. **Given** ユーザーがボットにURLを含めてメンションする、**When** ボットが処理キューに追加する、**Then** 確認メッセージにはURLが表示されず、Job IDと処理状態のみが表示される
2. **Given** 確認メッセージが投稿される、**When** Slackがメッセージを表示する、**Then** サムネイルやURL展開がされず、コンパクトなメッセージとして表示される
3. **Given** ユーザーが複数のURLを連続して投稿する、**When** 各確認メッセージが投稿される、**Then** チャンネルがサムネイルで埋まらず、スッキリした表示になる

---

### Edge Cases

- スレッド返信でURLが親投稿にある場合でも、確認メッセージにはURLを含めない
- 複数のURLが検出された場合（メンション + 親投稿）でも、確認メッセージは同じフォーマット
- エラーメッセージ（URL未検出など）では変更不要（URLを含まないため）

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 処理キュー追加の確認メッセージにはURLを含めてはならない
- **FR-002**: 確認メッセージには処理受付の状態（✅）、Job ID、処理予定を明示する
- **FR-003**: 確認メッセージはコンパクトで読みやすい形式である
- **FR-004**: Slackのメッセージフォーマットでサムネイル展開が発生しない
- **FR-005**: 処理完了メッセージ（結果投稿）は変更せず、現在のフォーマット済みリンクを維持する

### Key Entities

このfeatureはメッセージフォーマットの変更のみで、新しいエンティティは関与しない。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 処理キュー追加の確認メッセージでSlackのサムネイル展開が0件になる（現在は100%展開される）
- **SC-002**: 確認メッセージの文字数が50%削減される（URLが含まれないため）
- **SC-003**: ユーザーがボットメッセージを「スッキリしている」と評価する（主観的だが、視覚的なノイズ削減により向上）
- **SC-004**: チャンネル内でのボットメッセージの視覚的スペース消費が削減される

## Assumptions

- Slackのサムネイル展開は、メッセージ内にURLが直接含まれる場合に発生する
- URLを`<URL>`形式でラップするか、URLを完全に削除することでサムネイル展開を防げる
- ユーザーは既にURLを入力しているため、確認メッセージでURLを再表示する必要はない
- 処理完了メッセージ（結果投稿）でのフォーマット済みリンクは有用なため、変更不要

## Scope

### In Scope

- 処理キュー追加確認メッセージのフォーマット変更
- サムネイル展開の防止
- メッセージの簡潔化

### Out of Scope

- 処理完了メッセージのフォーマット変更（現在のフォーマット済みリンクは維持）
- エラーメッセージの変更（既にURLを含まない）
- 他のボットメッセージ（進捗通知など、将来実装予定の機能）
